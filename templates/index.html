<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Management Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Figtree:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="{{url_for('static', filename='style.css')}}">
</head>

<body>
    <div id="toast" class="toast"></div>
    <div id="confirmModal" class="modal">



        <div class="modal-box">
            <h3>Confirm Deletion</h3>
            <p>This action cannot be undone.</p>
            <div class="modal-actions">
                <button onclick="closeConfirm()" class="btn cancel">Cancel</button>
                <button onclick="confirmDelete()" class="btn danger">Delete</button>
            </div>
        </div>
    </div>


    <div class="sidebar">
        <h1>School Admin</h1>
        <button class="nav-btn active" onclick="showPage('dashboard')">üìä Dashboard</button>
        <button class="nav-btn" onclick="showPage('students')">üë• Manage Students</button>
        <button class="nav-btn" onclick="showPage('Managefees')">üí∞ Manage Fee </button>
        <button class="nav-btn" onclick="showPage('feestablepage')">üìä Fee Table</button>
        <button class="nav-btn" onclick="showPage('performance')">üìà Class Performance</button>
        <button class="nav-btn" onclick="showPage('teachers')">üë®‚Äçüè´ Manage Teachers</button>
        <button class="nav-btn" onclick="showPage('school')">üìÖ School Info</button>
    </div>

    <div class="main-content">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page active">
            <h2>Dashboard Overview</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="number" id="totalStudents">0</div>
                    <h3>Total Students</h3>
                </div>
                <div class="stat-card">
                    <div class="number" id="totalTeachers">0</div>
                    <h3>Total Teachers</h3>
                </div>
                <div class="stat-card">
                    <div class="number" id="totalFees">$0</div>
                    <h3>Fee Collection</h3>
                </div>
            </div>
            <div class="chart-grid">
                <div class="card">
                    <h3>Fee Status Distribution</h3>
                    <div class="chart-container">
                        <canvas id="feeChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>Recent Activities</h3>
                    <div class="event-list">
                        <div class="event-item">üìù New student enrolled</div>
                        <div class="event-item">üíµ Fee payment received</div>
                        <div class="event-item">üìÖ Event scheduled</div>
                        <div class="event-item">üë®‚Äçüè´ New teacher added</div>
                    </div>
                </div>
            </div>
        </div>



        <!-- Students Page -->
        <div id="students" class="page">


            <div class="stats-grid">
                <div class="stat-card">
                    <div class="number" id="totalfeecollection">0</div>
                    <h3>Total Fee Paid</h3>
                </div>
                <div class="stat-card">
                    <div class="number" id="totalpendingdues">0</div>
                    <h3>Total Dues </h3>
                </div>
                <div class="stat-card">
                    <div class="number" id="totalpendingstudents">$0</div>
                    <h3>Status</h3>
                </div>
            </div>

            <div class="topbar">

                <div class="topbar-actions">

                    <button class="btn" onclick="studentcard()">
                        <img style="height: 25px; width: 25px; border-radius: 0px;"
                            src="https://static.thenounproject.com/png/847977-200.png" alt="">

                        Add Student
                    </button>
                    <button class="btn" onclick="delete_student_card()">
                        <img style="height: 25px; width: 25px; border-radius: 0px;"
                            src="https://static.thenounproject.com/png/847983-200.png" alt="">
                        Delete Student
                    </button>

                </div>
            </div>

  <!-- student card for details  -->


            <div id="studentcard" style="max-width:1100px;margin:0 auto; display: none;">

                <!-- 3-Card Grid -->
                <div class="student-section">

                    <div class="card">
                        <div class="profile-header">
                            <div class="profile-avatar"><img id="studentavatar"
                                    style="height: 150px; width: 150px; border-radius:20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"
                                    src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR3fOjNVqsYLz_3u4qAZyKoJyCBuIqCt7zhxw&s"
                                    alt=""></div>
                            <div class="profile-name" id="studentname">Rehan Bhatti</div>
                            <div class="profile-program" style="color: black; font-size: 18px;" id="studentclass">BS Mathematics ¬∑ Semester 4</div>
                            <div class="profile-status" >Active Enrollment</div>
                        </div>

                        <div class="profile-stats">
                            <div class="profile-stat">
                                <div class="ps-val" style="color: darkblue;">88%</div>
                                <div class="ps-label">Attendance</div>
                            </div>
                            <div class="profile-stat">
                                <div class="ps-val" style="color: goldenrod;">3.6</div>
                                <div class="ps-label">CGPA</div>
                            </div>
                            <div class="profile-stat">
                                <div class="ps-val" style="color: red;">$500</div>
                                <div class="ps-label">Due</div>
                            </div>
                        </div>

                        <div style="padding:16px 22px;border-bottom:1px solid var(--border)">
                            <div style="display:flex;flex-direction:column;gap:10px">
                                <div  style="display:flex;align-items:center;gap:10px;font-size:13px">
                                    <span
                                        style="width:28px;height:28px;background:#f0f4ff;border:1px solid #e0e7ff;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0">üìû</span>
                                    <h12 id="studentcontact">N/A</h12>
                                </div>
                                <div style="display:flex;align-items:center;gap:10px;font-size:13px">
                                    <span
                                        style="width:28px;height:28px;background:#f0f4ff;border:1px solid #e0e7ff;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0">‚úâÔ∏è</span>
                                    <h12 id="studentemail">N/A</h12>
                                </div>
                                <div  style="display:flex;align-items:center;gap:10px;font-size:13px">
                                    <span
                                        style="width:28px;height:28px;background:#f0f4ff;border:1px solid #e0e7ff;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0">üìç</span>
                                    <h12 id="studentaddress">N/A</h12>
                                </div>
                            </div>
                        </div>

                        <div class="profile-actions">
                            <button class="btn " style="justify-content:center">üí¨ Message</button>
                            <button class="btn btn-outline btn-sm"
                                style="justify-content:center;color:red;border:1px solid red;"
                                onclick="alert('Delete student?')">üóë Delete</button>
                        </div>
                    </div>

                    <!-- ‚îÄ‚îÄ CARD 2: GENERAL DETAILS ‚îÄ‚îÄ -->
                    <div class="card">
                        <div class="card-header">
                            <div>
                                <div class="card-label" style="font-size:20px;">Information</div>
                                <div class="card-title">General Details</div>
                            </div>
                            <button
                                style="box-shadow: 0 6px 4px rgba(185, 185, 185, 0.5); border: 1px solid rgb(214, 214, 214);"
                                class="btn">‚úèÔ∏è Edit</button>
                        </div>

                        <div class="details-grid">
                            <div class="detail-item">
                                <div class="detail-label">Roll Number</div>
                                <div class="detail-value" id="studentroll">1023</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Section</div>
                                <div class="detail-value" id="studentsection">A ‚Äî Morning</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Father's Name</div>
                                <div class="detail-value" id="studentfather">Ahmed Khan</div>
                            </div>

                            <div class="detail-item">
                                <div class="detail-label">Date of Birth</div>
                                <div class="detail-value" id="studentdob">15 March 2002</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Gender</div>
                                <div class="detail-value" id="studentgender">Male</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">CNIC / B-Form</div>
                                <div class="detail-value" id="studentbform">35202-1234567-1</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Enrollment Date</div>
                                <div class="detail-value" id="studentenrollmentdate">Sept 2022</div>
                            </div>

                            <div class="detail-item">
                                <div class="detail-label">Guardian Contact</div>
                                <div class="detail-value" id="studentcontact">+92 321 0000000</div>
                            </div>

                        </div>
                        <div class="card-row" style="display: flex; gap: 10px; padding: 20px;">
                            <div class="card" style="width: 50%;">
                                <h1>Hello world</h1>
                            </div>
                            <div class="card" style="width: 50%;">
                                <h1>Hello world</h1>
                            </div>
                        </div>
                    </div>

                    <!-- ‚îÄ‚îÄ CARD 3: TABBED LISTS ‚îÄ‚îÄ -->
                    <div class="card">
                        <div class="card-header">
                            <div>
                                <div class="card-title">Student Records</div>
                            </div>
                        </div>

                        <!-- Tabs -->
                        <div class="tabs-bar">
                            <div class="tab-btn" onclick="switchStudentTab('transactions', this)">
                                <span class="tab-icon">üí∞</span> Transactions
                            </div>
                            <div class="tab-btn" onclick="switchStudentTab('attendance', this)">
                                <span class="tab-icon">üìÖ</span> Attendance
                            </div>
                            <div class="tab-btn" onclick="switchStudentTab('results', this)">
                                <span class="tab-icon">üìä</span> Results 
                            </div>
                            <div class="tab-btn" onclick="switchStudentTab('subjects', this)">
                                <span class="tab-icon">üìö</span> Subjects
                            </div>
                            <div class="tab-btn" onclick="switchStudentTab('remarks', this)">
                                <span class="tab-icon">üí¨</span> Remarks 
                            </div>
                        </div>

                        <!-- TRANSACTIONS -->
                        <div class="tab-panel" id="tab-transactions">
                            <table id="tab-fee-table" class="tab-fee-table list-table">
                                    <thead style="width: 100%;">
                                        <tr style="width: 100%;">
                                            <th>Name</th>
                                            <th>Roll no</th>
                                            <th>Month</th>
                                            <th class="discount-col">Add. Discount</th>
                                            <th>Total Paid</th>
                                            <th>Dues</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>

                        </div>

                        <!-- ATTENDANCE -->
                        <div class="tab-panel" id="tab-attendance">
                            <table class="list-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Day</th>
                                        <th>Status</th>
                                        <th>Remarks</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="color:var(--muted)">Feb 19, 2026</td>
                                        <td>Wednesday</td>
                                        <td><span class="att-badge att-present">‚úì Present</span></td>
                                        <td>‚Äî</td>
                                    </tr>
                                    <tr>
                                        <td style="color:var(--muted)">Feb 18, 2026</td>
                                        <td>Tuesday</td>
                                        <td><span class="att-badge att-present">‚úì Present</span></td>
                                        <td>‚Äî</td>
                                    </tr>
                                    <tr>
                                        <td style="color:var(--muted)">Feb 17, 2026</td>
                                        <td>Monday</td>
                                        <td><span class="att-badge att-absent">‚úó Absent</span></td>
                                        <td>Not informed</td>
                                    </tr>
                                    <tr>
                                        <td style="color:var(--muted)">Feb 14, 2026</td>
                                        <td>Friday</td>
                                        <td><span class="att-badge att-leave">~ Leave</span></td>
                                        <td>Medical leave</td>
                                    </tr>
                                    <tr>
                                        <td style="color:var(--muted)">Feb 13, 2026</td>
                                        <td>Thursday</td>
                                        <td><span class="att-badge att-present">‚úì Present</span></td>
                                        <td>‚Äî</td>
                                    </tr>
                                    <tr>
                                        <td style="color:var(--muted)">Feb 12, 2026</td>
                                        <td>Wednesday</td>
                                        <td><span class="att-badge att-holiday">‚óÜ Holiday</span></td>
                                        <td>Public holiday</td>
                                    </tr>
                                    <tr>
                                        <td style="color:var(--muted)">Feb 11, 2026</td>
                                        <td>Tuesday</td>
                                        <td><span class="att-badge att-present">‚úì Present</span></td>
                                        <td>‚Äî</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="list-footer">
                                <span>88% attendance this month</span>
                                <div class="page-btns">
                                    <div class="page-btn">‚Äπ</div>
                                    <div class="page-btn active">1</div>
                                    <div class="page-btn">2</div>
                                    <div class="page-btn">‚Ä∫</div>
                                </div>
                            </div>
                        </div>

                        <!-- RESULTS -->
                        <div class="tab-panel" id="tab-results">
                            <table class="list-table">
                                <thead>
                                    <tr>
                                        <th>Exam</th>
                                        <th>Subject</th>
                                        <th>Marks</th>
                                        <th>Grade</th>
                                        <th>Performance</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="color:var(--muted);font-size:12px">Mid-Term 2026</td>
                                        <td><strong>Mathematics</strong></td>
                                        <td>88 / 100</td>
                                        <td><span class="grade-cell grade-a">A</span></td>
                                        <td style="min-width:100px">
                                            <div style="font-size:11px;color:var(--muted);margin-bottom:3px">88%</div>
                                            <div class="mini-bar">
                                                <div class="mini-bar-fill bar-green" style="width:88%"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="color:var(--muted);font-size:12px">Mid-Term 2026</td>
                                        <td><strong>Physics</strong></td>
                                        <td>82 / 100</td>
                                        <td><span class="grade-cell grade-a">A</span></td>
                                        <td>
                                            <div style="font-size:11px;color:var(--muted);margin-bottom:3px">82%</div>
                                            <div class="mini-bar">
                                                <div class="mini-bar-fill bar-blue" style="width:82%"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="color:var(--muted);font-size:12px">Mid-Term 2026</td>
                                        <td><strong>English</strong></td>
                                        <td>90 / 100</td>
                                        <td><span class="grade-cell grade-a">A</span></td>
                                        <td>
                                            <div style="font-size:11px;color:var(--muted);margin-bottom:3px">90%</div>
                                            <div class="mini-bar">
                                                <div class="mini-bar-fill bar-green" style="width:90%"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="color:var(--muted);font-size:12px">Final 2025</td>
                                        <td><strong>Mathematics</strong></td>
                                        <td>76 / 100</td>
                                        <td><span class="grade-cell grade-b">B</span></td>
                                        <td>
                                            <div style="font-size:11px;color:var(--muted);margin-bottom:3px">76%</div>
                                            <div class="mini-bar">
                                                <div class="mini-bar-fill bar-blue" style="width:76%"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="color:var(--muted);font-size:12px">Final 2025</td>
                                        <td><strong>Physics</strong></td>
                                        <td>68 / 100</td>
                                        <td><span class="grade-cell grade-c">C</span></td>
                                        <td>
                                            <div style="font-size:11px;color:var(--muted);margin-bottom:3px">68%</div>
                                            <div class="mini-bar">
                                                <div class="mini-bar-fill bar-orange" style="width:68%"></div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="list-footer">
                                <span>CGPA: 3.6 ‚Äî Excellent</span>
                                <div class="page-btns">
                                    <div class="page-btn active">1</div>
                                    <div class="page-btn">2</div>
                                </div>
                            </div>
                        </div>

                        <!-- SUBJECTS -->
                        <div class="tab-panel" id="tab-subjects">
                            <table class="list-table">
                                <thead>
                                    <tr>
                                        <th>Subject</th>
                                        <th>Code</th>
                                        <th>Teacher</th>
                                        <th>Credit Hrs</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Advanced Mathematics</strong></td>
                                        <td style="color:var(--muted)">MTH-401</td>
                                        <td>Dr. Khalid</td>
                                        <td style="text-align:center">3</td>
                                        <td><span class="badge badge-green">Enrolled</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Classical Physics</strong></td>
                                        <td style="color:var(--muted)">PHY-301</td>
                                        <td>Prof. Sana</td>
                                        <td style="text-align:center">3</td>
                                        <td><span class="badge badge-green">Enrolled</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>English Communication</strong></td>
                                        <td style="color:var(--muted)">ENG-201</td>
                                        <td>Ms. Ayesha</td>
                                        <td style="text-align:center">2</td>
                                        <td><span class="badge badge-green">Enrolled</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Statistics</strong></td>
                                        <td style="color:var(--muted)">STA-301</td>
                                        <td>Dr. Imran</td>
                                        <td style="text-align:center">3</td>
                                        <td><span class="badge badge-green">Enrolled</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Linear Algebra</strong></td>
                                        <td style="color:var(--muted)">MTH-302</td>
                                        <td>Dr. Khalid</td>
                                        <td style="text-align:center">3</td>
                                        <td><span class="badge badge-green">Enrolled</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Pakistan Studies</strong></td>
                                        <td style="color:var(--muted)">PST-101</td>
                                        <td>Mr. Tariq</td>
                                        <td style="text-align:center">2</td>
                                        <td><span class="badge badge-blue">Completed</span></td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="list-footer">
                                <span>16 Credit Hours ‚Äî Semester 4</span>
                            </div>
                        </div>

                        <!-- REMARKS -->
                        <div class="tab-panel" id="tab-remarks">
                            <div style="padding:20px;display:flex;flex-direction:column;gap:14px">
                                <div
                                    style="background:#f8faff;border:1px solid var(--border);border-radius:14px;padding:18px">
                                    <div
                                        style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">
                                        <div style="display:flex;align-items:center;gap:8px">
                                            <div
                                                style="width:30px;height:30px;border-radius:9px;background:linear-gradient(135deg,#4f6ef7,#7c3aed);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:white;font-family:'Syne',sans-serif">
                                                AD</div>
                                            <div>
                                                <div style="font-size:13px;font-weight:600">Admin</div>
                                                <div style="font-size:11px;color:var(--muted)">Jan 10, 2026</div>
                                            </div>
                                        </div>
                                        <span class="badge badge-blue">Academic</span>
                                    </div>
                                    <p style="font-size:13.5px;color:var(--text);line-height:1.6">Student is performing
                                        well in Mathematics. Needs to improve attendance. Advised to submit medical
                                        certificate for Feb 17 absence.</p>
                                </div>
                                <div
                                    style="background:#f8faff;border:1px solid var(--border);border-radius:14px;padding:18px">
                                    <div
                                        style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">
                                        <div style="display:flex;align-items:center;gap:8px">
                                            <div
                                                style="width:30px;height:30px;border-radius:9px;background:linear-gradient(135deg,#10b981,#059669);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:white;font-family:'Syne',sans-serif">
                                                TC</div>
                                            <div>
                                                <div style="font-size:13px;font-weight:600">Class Teacher</div>
                                                <div style="font-size:11px;color:var(--muted)">Dec 20, 2025</div>
                                            </div>
                                        </div>
                                        <span class="badge badge-orange">Fee</span>
                                    </div>
                                    <p style="font-size:13.5px;color:var(--text);line-height:1.6">Partial fee payment
                                        for January. Parent contacted ‚Äî remaining $500 to be paid by Feb 5. Follow up
                                        required.</p>
                                </div>
                                <button class="btn btn-outline btn-sm" style="align-self:flex-start">+ Add
                                    Remark</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ============ -->

            <div class="card">
                <div> <img style="height: 45px; width: 45px;margin-left:10px ; border-radius: 0px;"
                        src="https://static.thenounproject.com/png/35785-200.png" alt="">
                    <h3>Students List</h3>
                </div>

                <div style="display:flex; gap:10px; align-items:center; margin-bottom:12px;">

                    <select style="width: 30%;" id="classfetchfilter">
                        <option value="9">Class 9</option>
                        <option value="10">Class 10</option>
                    </select>
                    <input style="margin: 5px 20px; width: 30%;" id="rollfetchfilter" placeholder="Roll num (Optional)">

                    <button onclick="fetchStudents()" class="btn btn-primary">
                        <img style="height: 25px; width: 25px; border-radius: 10%; box-shadow: none;"
                            src="https://icons.veryicon.com/png/o/miscellaneous/designer-icon-1/searchbar.png" alt="">

                    </button>

                </div>



                <table id="studentTable">
                    <thead>
                        <tr>
                            <th style="border-top-left-radius: 20px;">Name</th>
                            <th>Class</th>
                            <th>Section</th>
                            <th>Roll number</th>
                            <th>Gender</th>
                            <th>Father/Gaurdian</th>
                            <th></th>
                            <th style="border-top-right-radius: 20px;"></th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- ===============  -->


            <!-- ------------card  -->

            <div class="card" style="display: none; position: relative;" id="studentForm">
                <button class="close-btn" onclick="closeCard('studentForm')">
                    &times;
                </button>
                <h3 id="addlabel">Add New Student</h3>
                <h3 id="updatelabel" style="display: none;">Update Student</h3>

                <div class="image-upload-container">

                    <label for="imageInput" class="upload-box">
                        <img id="previewImage"
                            src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT-HmAlYRaMiTx6PqSGcL9ifkAFxWHVPvhiHQ&s"
                            alt="Preview">

                        <span class="upload-text">Click to upload image</span>
                    </label>

                    <input type="file" id="imageInput" accept="image/png, image/jpeg, image/webp">

                </div>
                <script>
                    document.getElementById("imageInput")
                        .addEventListener("change", function () {

                            const file = this.files[0];
                            if (!file) return;

                            const reader = new FileReader();

                            reader.onload = function (e) {
                                document.getElementById("previewImage").src = e.target.result;
                            };

                            reader.readAsDataURL(file);
                        });
                </script>
                <div class="form-grid">

                    <label style="font-size:16px;">Name
                        <input type="text" id="studentName" placeholder="Student Name" style="margin:5px 0;">
                    </label>

                    <label style="font-size:16px;">Date of Birth
                        <input type="date" id="studentDOB" style="margin:5px 0;">
                    </label>

                    <label style="font-size:16px;">B-form No
                        <input type="text" id="bform" maxlength="15" placeholder="12345-1234567-1" style="margin:5px 0;"
                            required>
                    </label>
                    <script>document.getElementById("bform").addEventListener("input", function () {

                            let digits = this.value.replace(/\D/g, ""); // Remove non-digits

                            if (digits.length > 13) {
                                digits = digits.slice(0, 13);
                            }

                            let formatted = "";

                            if (digits.length > 0) {
                                formatted = digits.slice(0, 5);
                            }

                            if (digits.length > 5) {
                                formatted += "-" + digits.slice(5, 12);
                            }

                            if (digits.length > 12) {
                                formatted += "-" + digits.slice(12, 13);
                            }

                            this.value = formatted;
                        });</script>

                    <label style="font-size:16px;">Gender
                        <select id="studentGender" required style="margin:5px 0;">
                            <option value="male">üöπMale</option>
                            <option value="female">üö∫Female</option>
                            <option value="other">Other</option>
                        </select>
                    </label>

                    <label id="classheading" style="font-size:16px;">Class
                        <select id="addstudentclass" required style="margin:5px 0;">
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </label>

                    <label style="font-size:16px;">Section
                        <input type="text" id="section" placeholder="e.g., A" style="margin:5px 0;">
                    </label>

                    <label id="rollheading" style="font-size:16px;">Roll Number
                        <input type="text" id="rollNumber" placeholder="e.g., A-123" style="margin:5px 0;">
                    </label>

                    <label style="font-size:16px;">Session
                        <input type="text" id="session" placeholder="e.g., 2024-25" style="margin:5px 0;">
                    </label>

                    <label style="font-size:16px;">Total Fee
                        <input type="number" id="totalFee" placeholder="e.g., 2000" style="margin:5px 0;">
                    </label>
                </div>

                <h3 style="font-size:18px;">Father/Guardian info</h3>

                <div class="form-grid">
                    <label style="font-size:16px;">Name
                        <input type="text" id="fatherName" placeholder="Full Name" style="margin:5px 0;">
                    </label>


                    <label style="font-size:16px;">Phone Number
                        <input type="text" id="phone" placeholder="e.g., 1234567890" style="margin:5px 0;">
                    </label>

                    <label style="font-size:16px;">Address
                        <input type="text" id="address" placeholder="Full Address" style="margin:5px 0;">
                    </label>

                </div>

                <button class="btn2 btn-primary" style="background: green;"
                    onmouseover="this.style.background='darkgreen'" onmouseout="this.style.background='green'"
                    type="submit" id="addBtn" onclick="addStudent()">Add
                    Student</button>

                <button class="btn2 btn-primary" id="updateBtn" style="display:none"
                    onclick="updateStudent(event)">Update
                    Student</button>

                <button class="btn2 btn-primary" type="button" id="cancelBtn" style="display:none; background: #991b1b"
                    onclick="cancelUpdate()">
                    Cancel
                </button>
            </div>


            <div class="card" id="deletestudentscard" style="display: none; position: relative;">

                <button class="close-btn" onclick="closeCard('deletestudentscard')">
                    &times;
                </button>
                <h3>Delete a Student</h3>
                <div class="form-grid">

                    <h3 style="font-size: 16px;"> Class
                        <select style="margin: 5px 0;" name="status" id="deletestudentclass" required>

                            <option value="9">
                                9
                            </option>
                            <option value="10">
                                10
                            </option>
                        </select>
                    </h3>
                    <h3 style="font-size: 16px"> Section
                        <input style="margin: 5px 0;" type="text" id="Section" placeholder="e.g., A">
                    </h3>
                    <h3 style="font-size: 16px"> Roll Number
                        <input style="margin: 5px 0;" type="text" id="Rollnumber" placeholder="e.g., A-123">
                    </h3>
                </div>
                <button class="btn2 btn-primary" style="background-color: #991b1b;"
                    onmouseover="this.style.background='darkred'" onmouseout="this.style.background='#991b1b'"
                    onclick="openConfirm()">Delete
                    Student</button>
                <button class="btn2 btn-primary" type="button" id="canceldeleteBtn"
                    style="display:none; background: #0044d6" onclick="canceldelete()">
                    Cancel Delete
                </button>

            </div>



        </div>

        <!-- students list page  -->

        <!-- Fees Page -->
        <section>
            <div id="Managefees" class="page">
                <h2>Fee Status Management</h2>

                <div class="card">
                    <h3>Add Record</h3>
                    <div class="form-grid">
                        <h3 style="font-size: 16px;"> Class
                            <select style="margin: 5px 0;" name="status" id="classforfee" required>

                                <option value="9">
                                    9
                                </option>
                                <option value="10">
                                    10
                                </option>
                            </select>
                        </h3>
                        <h3 style="font-size: 16px"> Section
                            <input style="margin: 5px 0;" type="text" id="Sectionforfee" placeholder="e.g., A">
                        </h3>
                        <h3 style="font-size: 16px"> Roll Number
                            <input style="margin: 5px 0;" type="text" id="Rollnumberforfee" placeholder="e.g., A-123">
                        </h3>
                        <h3 style="font-size: 16px"> Date
                            <input style="margin: 5px 0;" type="date" id="feedate" placeholder="MM/DD/YYYY">
                        </h3>
                        <h3 style="font-size: 16px;"> Month
                            <select style="margin: 5px 0;" id="feemonth" required>

                                <option value="january">
                                    January
                                </option>
                                <option value="feburary">
                                    Feburary
                                </option>
                                <option value="march">
                                    March
                                </option>
                                <option value="april">
                                    April
                                </option>
                                <option value="may">
                                    May
                                </option>
                                <option value="june">
                                    June
                                </option>
                                <option value="july">
                                    July
                                </option>
                                <option value="august">
                                    August
                                </option>
                                <option value="september">
                                    September
                                </option>
                                <option value="october">
                                    October
                                </option>
                                <option value="november">
                                    November
                                </option>
                                <option value="december">
                                    December
                                </option>
                            </select>
                        </h3>
                        <h3 style="font-size: 16px"> Amount paid
                            <input style="margin: 5px 0;" type="number" id="amount">
                        </h3>
                        <h3 style="font-size: 16px"> Due amount
                            <input style="margin: 5px 0;" type="number" id="Dues" </h3>
                            <h3 style="font-size: 16px;"> Payment
                                <select style="margin: 5px 0;" id="paymentmethod" required>

                                    <option value="cash">
                                        Cash
                                    </option>
                                    <option value="online">
                                        Online
                                    </option>
                                </select>
                            </h3>
                    </div>
                    <button class="btn2 btn-primary" style="background-color: green;" onclick="addfee()">Add</button>

                </div>

                <div class="card" id="showfeetable" style="display: none; border-radius: 30px;">
                    <div style="display:flex; gap:10px; align-items:center; margin-bottom:12px;">

                    </div>
                    <table id="feeTable">
                        <thead id="tablehead">
                            <tr>
                                <th style="border-top-left-radius: 20px;">Name</th>
                                <th>Class</th>
                                <th>Roll no.</th>
                                <th>Month</th>
                                <th>Amount Paid</th>
                                <th>Paid on</th>
                                <th style="border-top-right-radius: 20px;">Dues</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>


        </section>

        <!-- ============Fee table of stundents======== -->


        <div id="feestablepage" class="page">

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="number" id="totalfeecollection">0</div>
                    <h3>Total Fee Paid</h3>
                </div>
                <div class="stat-card">
                    <div class="number" id="totalpendingdues">0</div>
                    <h3>Total Dues </h3>
                </div>
                <div class="stat-card">
                    <div class="number" id="totalpendingstudents">$0</div>
                    <h3>Status</h3>
                </div>
            </div>

            <div style="display:flex; gap:10px; align-items:center; margin-bottom:12px;">

                <select style="width: 20%;" id="feeclassfilter">
                    <option value="9">Class 9</option>
                    <option value="10">Class 10</option>
                </select>
                <select style="width: 20%;" id="feemonthfilter">

                    <option value="january">
                        January
                    </option>
                    <option value="feburary">
                        Feburary
                    </option>
                    <option value="march">
                        March
                    </option>
                    <option value="april">
                        April
                    </option>
                    <option value="may">
                        May
                    </option>
                    <option value="june">
                        June
                    </option>
                    <option value="july">
                        July
                    </option>
                    <option value="august">
                        August
                    </option>
                    <option value="september">
                        September
                    </option>
                    <option value="october">
                        October
                    </option>
                    <option value="november">
                        November
                    </option>
                    <option value="december">
                        December
                    </option>
                </select>
                <input style="margin: 5px 20px; width:30%" id="feerollfilter" placeholder="Roll num (Optional)">

                <button onclick="fetchstudentsfee()" class="btn btn-primary">
                    Refresh
                </button>

            </div>
            <!-- card----- -->
            <div>
                <div class="topbar">

                    <div class="topbar-actions">
                        <button id="backbtninfee" style="display: none;" class="btn" onclick="backbtn_in_feepage()">
                            ‚¨â Back
                        </button>
                        <button class="btn">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="6 9 6 2 18 2 18 9" />
                                <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" />
                                <rect x="6" y="14" width="12" height="8" />
                            </svg>
                            Print
                        </button>
                        <button class="btn">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" />
                                <path d="M13.73 21a2 2 0 0 1-3.46 0" />
                            </svg>
                            Send Reminder
                        </button>
                        <button class="btn">Show Advance Fee</button>
                    </div>
                </div>

                <div class="main" id="feecard" style="display: none;">
                    <div class="left-col">
 
                        <div class="profile-card">
                            <div class="avatar-wrap">
                                <div class="avatar"><img
                                        src="https://res.cloudinary.com/dhcayqpqr/image/upload/v1771685889/movde8tv3nwycpx2lwnf.jpg"
                                        style="height: 100px; width: 100px; border-radius: 60%;" alt=""></div>
                            </div>
                            <div class="profile-info">
                                <h2 id="nameofstudent">Ayesha Bibi <span class="tag">PARENT</span></h2>
                                <div class="sub" id="rollofstudent">ID: AB-0042 &nbsp;|&nbsp; Flat 45 Block B
                                    Lahore
                                </div>
                                <div class="sub" id="classofstudent">ID: AB-0042 &nbsp;|&nbsp; Flat 45 Block B
                                    Lahore</div>
                                <div class="toggle-row">
                                    <label class="toggle">
                                        <input type="checkbox" id="discountToggle">
                                        <span class="slider"></span>
                                    </label>
                                    <span class="toggle-label">Show Discount</span>
                                </div>
                            </div>
                            <div class="profile-meta">
                                <div class="phone">03217654321</div>
                            </div>
                        </div>

                        <div class="student-card">
                            <div class="student-header">
                                <div class="student-avatar">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                                        <circle cx="12" cy="7" r="4" />
                                    </svg>
                                </div>
                                <div class="student-meta">
                                    <h3>
                                        Zainab Bibi
                                        <button class="eye-btn">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                                <circle cx="12" cy="12" r="3" />
                                            </svg>
                                        </button>
                                    </h3>
                                </div>
                                <div>
                                    <div class="student-class">Eight <span>Class A</span></div>
                                </div>
                                <div class="total-fee">
                                    <div class="amount" id="totalFeeDisplay">81,331 PKR</div>
                                    <div class="label">Total Fee</div>
                                </div>
                            </div>

                            <div class="table-wrap">
                                <table class="fee-table">
                                    <thead>
                                        <tr>
                                            <th>Month</th>
                                            <th>Type</th>
                                            <th>Reason</th>
                                            <th class="discount-col">Add. Discount</th>
                                            <th>Total Paid</th>
                                            <th>Date</th>

                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="right-panel">
                        <div class="stat-card">
                            <div class="number" style="color: green; font-weight: 600;" id="studentTotalPaid">0
                            </div>
                            <h3>Total Fee Paid</h3>
                        </div>
                        <div class="stat-card">
                            <div class="number" style="color: red; font-weight: 600;" id="studentTotalDue">0
                            </div>
                            <h3>Total Dues </h3>
                        </div>
                        <div class="stat-card">
                            <div class="number" id="studentStatus">$0</div>
                            <h3>Status</h3>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ------------card -----  -->

            <div class="card" id="feepagetable" style="display: block; border-radius: 30px;">
                <table id="generalfeeTable" class="fee-table">
                </table>
            </div>


        </div>


        <!-- Performance Page -->
        <div id="performance" class="page">
            <h2>Class Performance</h2>
            <div class="chart-grid">
                <div class="card">
                    <h3>Average Scores by Class</h3>
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>Student Count by Class</h3>
                    <div class="chart-container">
                        <canvas id="studentCountChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="card">
                <h3>Class Details</h3>
                <table id="performanceTable">
                    <thead>
                        <tr>
                            <th>Class</th>
                            <th>Average Score</th>
                            <th>Total Students</th>
                            <th>Performance</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Teachers Page -->
        <div id="teachers" class="page">
            <h2>Manage Teachers</h2>
            <div class="card">
                <h3>Add New Teacher</h3>
                <div class="form-grid">
                    <input type="text" id="teacherName" placeholder="Teacher Name">
                    <input type="text" id="teacherSubject" placeholder="Subject">
                    <input type="text" id="teacherClass" placeholder="Class">
                    <button class="btn btn-primary" onclick="addTeacher()">Add Teacher</button>
                </div>
            </div>
            <div class="card">
                <h3>Teacher List</h3>
                <table id="teacherTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Subject</th>
                            <th>Class</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>


        <!-- School Info Page -->
        <div id="school" class="page">
            <h2>School Information</h2>
            <div class="chart-grid">
                <div class="card">
                    <h3>‚è∞ School Timings</h3>
                    <input type="text" id="schoolTimings" value="8:00 AM - 2:00 PM">
                    <button class="btn btn-primary" style="margin-top: 15px;" onclick="updateTimings()">Update
                        Timings</button>
                </div>
                <div class="card">
                    <h3>üìÖ Add Event</h3>
                    <input type="text" id="eventInput" placeholder="Enter event">
                    <button class="btn btn-success" style="margin-top: 15px;" onclick="addEvent()">Add
                        Event</button>
                </div>
            </div>
            <div class="chart-grid">
                <div class="card">
                    <h3>Upcoming Events</h3>
                    <ul class="event-list" id="eventList"></ul>
                </div>
                <div class="card">
                    <h3>Schedules</h3>
                    <ul class="event-list" id="scheduleList"></ul>
                </div>
            </div>
        </div>
    </div>


    <script src="{{url_for('static', filename='script.js')}}">

    </script>

    <div id="loaderOverlay" style="display:none;">
        <div class="spinner"></div>
    </div>
</body>

</html>